\documentclass[12pt, letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage[margin=1in, left=0.75in, right=0.75in]{geometry}
\usepackage{booktabs}
\usepackage{tabu}
\usepackage[labelfont=bf, skip=5pt, font=small]{caption}
\usepackage{subcaption}
\usepackage[style=chem-acs, articletitle=true]{biblatex}
\usepackage{tocloft}
\usepackage{setspace}
\usepackage{hyperref}
% \addbibresource{}

\setlength{\parskip}{2em}
\setlength{\parindent}{0em}

\begin{document}

\begin{center}
    % \vspace*{-1in}
    % \vspace*{0.5em}
    \Huge\textbf{Tracking Players In \\ Sports Videos} \\[12pt]
    \Large{An investigation into tracking ice hockey \\ players in professional matches} \\[55pt]
    \huge\textbf{Yerassyl Kutylbek} \\[6pt]
    \Large\textbf{ID Number:} {10825970} \\[5pt]
    \Large{Supervised by Dr Aphrodite Galata} \\[5pt]
    \date\Large{April 30, 2024} \\[90pt]

    \large{A report submitted as part of the Third Year Project for} \\[3pt]
    \large{the degree of BSc (Hons) Artificial Intelligence}
    \centering
    \includegraphics[width=0.6\textwidth]{uom_logo.png} \\
    \large{School of Computer Science} \\[5pt]
    \large{The University of Manchester}
\end{center}

\tableofcontents
\newpage

% \section*{\Huge List of Tables}
% \addcontentsline{toc}{section}{List of Tables}
\listoftables
\newpage

\hypertarget{listoffigures}{}
\addcontentsline{toc}{section}{\protect\hyperlink{listoffigures}{List of Figures}} 
\listoffigures
\newpage

% Abstract
\section*{\Huge Abstract}
\addcontentsline{toc}{section}{Abstract}
\begin{spacing}{1.3}
% Abstract text here
In the context of ice hockey, a sport known for its speed and complexity, the need for advanced player-tracking systems is particularly pronounced. This project introduces a comprehensive system designed to track ice hockey players in professional match videos with unprecedented accuracy and efficiency, leveraging the YOLO object detection framework and Deep SORT algorithm to accurately identify and follow players, and clustering techniques to distinguish teams and referees. It represents a significant leap in sports analytics, offering precise player detection and tracking, team classification, and a bird's-eye view transformation of the ice rink for advanced strategic analysis. Evaluated across key metrics, the system achieved an impressive player and referee detection mean Average Precision (mAP) of 96\% and facilitated groundbreaking insights into player positioning and team tactics through its bird's-eye view feature. This advancement underscores the transformative potential of integrating machine learning and computer vision in sports analytics, providing a powerful tool for performance analysis and showcasing a notable contribution to the strategic understanding of professional ice hockey.
\end{spacing}
\newpage

% Declaration
% \section*{\Huge Declaration}
% \addcontentsline{toc}{section}{Declaration}
% Declaration text here
% \newpage

% Acknowledgements
% \section*{\Huge Acknowledgements}
% \addcontentsline{toc}{section}{Acknowledgements}
% Acknowledgements text here
% \newpage

\section{Introduction}

{
\setlength{\parskip}{0.3cm}
\subsection{Context and Motivation}
\begin{spacing}{1.2}
The emergence of advanced analytics in sports, leveraging machine learning and computer vision, has revolutionized how games are analyzed and understood. Specifically, ice hockey, with its fast-paced and intricate team dynamics, presents a unique set of challenges and opportunities for technological innovation. This project lies at the intersection of these technological advancements and the growing demand for in-depth sports analytics.

The primary motivation for this investigation stems from the inherent limitations of traditional player tracking methods in ice hockey, which are mainly manual, tedious, and not sufficiently robust to capture the complex, high-speed movements that are typical of the sport. These traditional methods often yield data that lacks the depth and precision necessary for a comprehensive analysis of player performance and team strategies.

% In response to these challenges, recent studies have explored the potential of machine learning and computer vision to provide more detailed and accurate tracking of player movements. For instance, the work by [Author et al., Year] demonstrated the application of the YOLO (You Only Look Once) object detection model and Deep SORT tracking algorithm in real-time player tracking across various sports. However, the unique context of ice hockey, with its rapid changes in player positions and frequent occlusions, calls for a specialized approach that can reliably distinguish between players, referees, and the puck, while also adapting to the sport's fast-paced nature.

This project aims to develop a comprehensive system tailored to the specific demands of ice hockey, including advanced object detection, player tracking, and team classification methodologies. Consequently, the goal is to address the essential requirement for accurate and automated tracking in professional ice hockey games, offering teams and coaches valuable insights to guide strategic choices and improve overall team performance.

Furthermore, the project recognizes the growing interest in sports analytics for performance optimization and enhancing fan engagement and viewership experiences. By facilitating a more detailed analysis of game dynamics, player tracking systems contribute to more engaging and immersive viewing experiences, potentially transforming how fans engage with the sport.

In summary, this project is motivated by the intersection of technical challenges, the potential for significant contributions to sports analytics in ice hockey, and the broader implications for team performance and fan engagement. Through the investigation grounded in the latest research and technological innovations, it aims to push the boundaries of what is possible in sports analytics and player tracking.
\end{spacing}
}
\newpage

{
\setlength{\parskip}{0.3cm}
\subsection{Aims and Objectives}
The project aims to develop a comprehensive system for tracking ice hockey players and referees in professional match videos with high accuracy and efficiency. The objectives include:

1. Implementing an advanced object detection model to accurately identify players and referees.

2. Utilizing a robust tracking algorithm to maintain consistent player identities across video frames.

3. Differentiating between opposing teams using clustering techniques.

4. Mapping player positions from video frames to a 2D rink model for strategic analysis.

5. Generating heat maps to visualize player movements and game dynamics.

6. Evaluating the system's performance across various metrics, including detection accuracy, tracking consistency, and computational efficiency.
}

{
\setlength{\parskip}{0.3cm} % Adjust the vertical space between paragraphs as needed
\subsection{Report Structure}
The report is structured into six chapters to systematically cover every aspect of the project:

\begin{itemize}
    \item Chapter 1: Introduces the project, outlining the context, motivation, aims, and objectives.
    
    \item Chapter 2: Reviews relevant literature and technologies that underpin the methodologies applied in this project, providing a foundation for the approaches chosen.
    
    \item Chapter 3: Details the methodology and implementation process, including planning, data collection and annotation, detection and tracking of players and referees, team classification, bird’s-eye view transformation, and heatmap generation.
    
    \item Chapter 4: Focuses on the evaluation of the system, discussing the preparation of datasets, detection and tracking accuracy, parameter optimization, and overall system performance.
    
    \item Chapter 5: Discusses the project's achievements, reflecting on the challenges faced, insights gained, and potential areas for further research. Additionally, concludes the report, summarizing the key outcomes and proposing directions for future work on the topic.
\end{itemize}
}
\newpage

\section{Background}
{
\setlength{\parskip}{0.3cm}
\subsection{Machine Learning in Sports Analytics}
\begin{spacing}{1.2}
The integration of machine learning (ML) into sports analytics marks a paradigm shift from conventional statistical methods to more sophisticated, predictive models that can analyze complex patterns and interactions within sports data. This transition is driven by the demand for more accurate analytics to enhance team performance, strategy formulation, and player evaluation. Machine learning (ML) is a branch of artificial intelligence that focuses on building systems that learn from data. Rather than being explicitly programmed to perform a task, these systems are trained on a dataset, allowing them to improve their performance over time as they are exposed to more data. In the context of sports analytics, ML techniques are used to process and analyze vast amounts of game data to uncover patterns, make predictions, and provide insights that can enhance decision-making for teams and coaches.

The effectiveness of machine learning in sports analytics is predicated on its ability to handle the high dimensionality of sports data and to learn from data to make accurate predictions or classifications. Unlike traditional statistical methods that often require simplifications or assumptions about the data, ML algorithms can model complex relationships within the data, offering a more nuanced understanding of game dynamics. This capability is valuable in sports like ice hockey, where the fast pace and intricate team dynamics present unique analytical challenges.

The integration of machine learning into sports analytics represents a significant advancement in how sports data is analyzed and utilized. By leveraging complex algorithms to interpret and predict sports outcomes, ML opens new avenues for performance optimization, strategic planning, and enhancing the competitive edge of teams and athletes. This overview sets the stage for exploring specific ML techniques and their application in tracking players in professional ice hockey matches, which is the focus of this project.

% References:
% Rein, R., & Memmert, D. (2016). Big data and tactical analysis in elite soccer: Future challenges and opportunities for sports science. SpringerPlus, 5(1), 1410.
% Gudmundsson, J., & Horton, M. (2017). Spatio-temporal analysis of team sports. ACM Computing Surveys (CSUR), 50(2), Article 22.

\subsubsection{Convolutional Neural Networks (CNNs) in Player Detection}
One of the key ML techniques employed in player detection within sports videos is the convolutional neural network (CNN). CNNs are a class of deep neural networks that are particularly effective at analyzing visual imagery. They use a series of convolutional layers to automatically and adaptively learn spatial hierarchies of features from input images. This capability makes them exceptionally suited for tasks such as image recognition, object detection, and even video analysis.

Convolutional Neural Networks (CNNs) stand out in the machine learning landscape for their exceptional ability to process and analyze images, making them ideal for applications such as player detection in sports videos. The architecture of a CNN is designed to mimic the way the human visual cortex works, allowing it to efficiently recognize patterns, shapes, and objects within complex visual inputs.

A CNN is composed of several layers that process and transform the input image to extract relevant features for the task at hand, such as detecting players on a sports field. A CNN architecture is shown in Figure~\ref{fig:cnn}. These layers include:

\begin{itemize}
    \item \textbf{Convolutional Layers}: The backbone of a CNN, these layers apply filters (or kernels) to the input image to create feature maps. Each filter is designed to detect specific features, such as edges, textures, or parts of objects (e.g., a player's jersey or helmet). By sliding the filter across the image, the network can capture spatial hierarchies of features, from simple to complex.

    \item \textbf{Activation Layers}: Following convolution, an activation function such as the Rectified Linear Unit (ReLU) is applied to introduce non-linearity into the network. This step is crucial for enabling the CNN to learn and model complex patterns in the data.

    \item \textbf{Pooling Layers}: These layers reduce the dimensionality of the feature maps, making the detection process computationally efficient while retaining essential information. Max pooling, for example, reduces the size of the feature maps by taking the maximum value in a specific window, enhancing the network's ability to focus on the most prominent features.

    \item \textbf{Fully Connected Layers}: Towards the end of the CNN architecture, fully connected layers combine all the features learned by previous layers to classify the image or detect objects within it. In the context of player detection, this involves determining whether a region of the image contains a player and identifying the player's location.

    \item \textbf{Output Layer}: The final layer outputs the detection results, typically in the form of bounding boxes around detected players and classification scores indicating the confidence level of the detections.
\end{itemize}

\begin{figure}[htbp]
\centering
\includegraphics[width=\linewidth]{CNN.png}
\captionsetup{font=large}
\caption{Convolutional Neural Network}
\label{fig:cnn}
\end{figure}

Training a CNN involves showing it thousands of labeled images, where the locations of players are marked with bounding boxes. The network adjusts its weights through a process known as backpropagation, where the difference between the predicted output and the actual label is used to update the weights in a way that minimizes this difference. This learning process enables the CNN to improve its ability to detect players as it goes through more training images.

The YOLO algorithm represents a significant advancement in utilizing CNNs for object detection, including player detection. Unlike traditional approaches that scan an image in parts to find objects, YOLO looks at the entire image in a single pass, predicting bounding boxes and class probabilities directly from the full images. This holistic approach allows YOLO to detect objects, such as players, rapidly and accurately, making it highly effective for real-time sports analytics applications.

By leveraging CNNs and advanced algorithms like YOLO, player detection systems can achieve remarkable accuracy, enabling detailed analysis of game dynamics and player movements without manual labeling or tracking. This automated, efficient processing of visual data opens up new possibilities for enhancing sports strategies, player evaluations, and audience engagement through enriched visual content.

\subsubsection{Support Vector Machines (SVMs) for Player Classification}

Support Vector Machines (SVMs) serve as a robust tool for classification tasks within the domain of machine learning, excelling for tasks such as differentiating between player types or identifying referees among players in the context of sports analytics. SVM is a supervised learning model renowned for its application in both classification and regression challenges.

The fundamental operation of an SVM Figure~\ref{fig:SVM} involves constructing a hyperplane in a high-dimensional space. The goal is to find the hyperplane that best divides the dataset into classes, which is particularly advantageous for binary classification tasks. The decision to designate a hyperplane as "the best" hinges on its ability to offer the largest margin between the two classes it separates. This margin is the distance between the hyperplane and the nearest data point from either class, known as a support vector.

The steps to achieve this are as follows:

\begin{itemize}
    \item \textbf{Transformation into High-Dimensional Space}: In scenarios where the data is not linearly separable in its original space, SVM employs a technique called the kernel trick. This approach transforms the input data space into a higher-dimensional space where a linear separation is feasible without explicitly computing the coordinates in this new space, thus preserving computational efficiency.

    \item \textbf{Optimization of the Hyperplane}: The SVM algorithm seeks to maximize the margin between the classes by adjusting the orientation and position of the hyperplane. This process involves solving an optimization problem that determines the hyperplane parameters minimizing classification errors while maximizing the margin.

    \item \textbf{Support Vectors Identification}: The data points that are closest to the hyperplane and directly influence its position and orientation are identified as support vectors. These points are critical since their removal or alteration would change the hyperplane's construction.

    \item \textbf{Classification Decision}: Once the optimal hyperplane is established, SVM can classify new data points based on which side of the hyperplane they fall on. For binary classification, this involves assigning a class label based on the sign of the decision function, which is a measure of the distance of a data point from the hyperplane.
\end{itemize}

\begin{figure}[htbp]
\centering
\includegraphics[width=0.8\linewidth]{SVM.png}
\captionsetup{font=large}
\caption{Support Vector Machine}
\label{fig:SVM}
\end{figure}

In the realm of sports analytics, particularly in the context of tracking players in videos, SVMs play a crucial role in classifying detected objects post their detection. Features such as HSV histograms, extracted from the bounding boxes around detected players serve as inputs to the SVM. Based on these features, the SVM classifies each object as either a player, a referee, or an irrelevant object. This classification step is instrumental in refining the detection accuracy by filtering out objects that do not pertain to the game's context.

In essence, SVMs complement the object detection capabilities of CNNs by providing a reliable method for the subsequent classification of detected objects. This synergy between CNNs and SVMs empowers the development of sophisticated player tracking systems, driving forward the analytics in sports through detailed game dynamics and player performance insights.

\end{spacing}
}

{
\setlength{\parskip}{0.3cm}
\subsection{Player Detection Technologies}
\begin{spacing}{1.2}
\end{spacing}
}

\subsection{Color-based Team Classification using HSV Histograms and K-means Clustering}
\subsection{Application of DeepSORT for Player Tracking}
\subsection{Field Point Detection and Homography for 2D Rink Mapping}
\subsection{Heatmap Generation for Strategic Analysis}
\subsection{Reference Framework and Peer-Reviewed Literature}
\newpage

\section{Methodology and Implementation}

\subsection{Planning}
\subsection{Data Collection and Annotation}
\subsubsection{Player and Referee Data}
\subsubsection{Ice Hockey Field Data}
\subsection{Player and Referee Detection}
\subsection{Ice Hockey Field Data Detection}
\subsubsection{\textbf{CHANGE}: Point Generatoin}
\subsubsection{\textbf{CHANGE}: Point Detection}
\subsection{Player and Referee Tracking}
\subsection{Team Classification}
\subsection{Bird’s-Eye View}
\subsection{Heatmap}
\subsection{System Design and Implementation}
\subsection{Python}
\newpage

\section{Evaluation}

\subsection{Data Preperation}
\subsection{Player and Referee Detection}
\subsubsection{\textbf{CHANGE}: Hyperparameter Tuning}
\subsubsection{\textbf{CHANGE}: \textbf{CHANGE}: Optimisation of Detection Parameters}
\subsection{\textbf{CHANGE}: Field Point Detection}
\subsubsection{\textbf{CHANGE}: Hyperparameter Tuning}
\subsubsection{\textbf{CHANGE}: Optimisation of Detection Parameters}
\subsection{Player and Referee Tracking}
\subsection{Team Classification}
\newpage

\section{Conclusion and Reflections}

\subsection{Achievements}
\subsection{Self Reflection}
\subsection{Future Work}
\subsubsection{1}
\subsubsection{2}
\subsubsection{3}
\subsection{Conclusion}
\newpage


\addcontentsline{toc}{section}{References}

\end{document}
